{% extends 'ctflex/base/headered.template.html' %}
{% load ctflex %}

{% block title %}
  Team Profile â€” {{ block.super }}
{% endblock %}

{% block header %}
  {{ team.name }}
{% endblock %}

{% block content %}
  <div class="panel-group">
    <div class="panel panel-primary">
      <div class="panel-body">
        {# XXX(Cam): TBH I actually like it better this way than with panel headers. #}
        <h3>General Information</h3>
        <table class="table table-striped">
          <tr>
            <td><strong>Team Name</strong></td><td>{{ team.name }}</td>
          </tr>
          <tr>
            <td><strong>Affiliation</strong></td><td>{{ team.affiliation }}</td>
          </tr>
          <tr>
            <td><strong>Overall Score</strong></td><td>{{ total_score }}</td>
          </tr>
          <tr>
            <td><strong>Members</strong></td>
            <td><ul style="list-style:none; padding-left:0;">
              {% for usr in team.competitor_set.all %}
              <li>
                {{ usr.first_name }} {{ usr.last_name }}</br>
                <span style="font-size:8pt">{{ usr.user.username }}</span>
              </li>
              {% endfor %}
            </ul></td>
          </tr>
        </table>
      </div>
    </div>
    <div class="panel panel-primary">
      <div class="panel-body">
        <h3>Info by Round</h3>
        <div class="panel-group" id="rounds-accordion">
          {% for window, score, solves in windows_data %}
            <div class="panel panel-primary">
              <div class="panel-heading clearfix" data-toggle="collapse"
              data-target="#window-{{ window.id }}" data-parent="#rounds-accordion">
                <span>{{ window.verbose_name }}</span><span class="pull-right">{{ score }} points</span>
              </div>
              <div id="window-{{ window.id }}" class="panel-collapse collapse">
                <div class="panel-body">
                  {% if solves %}
                    <table class="table table-striped table-hover">
                      <tr>
                        <th>Problem</th>
                        <th>Solved by</th>
                        <th>When</th>
                      </tr>
                      {% for solve in solves %}
                        <tr>
                          <td>{{ solve.problem.name }}</td>
                          <td>{{ solve.competitor.user.username }}</td>
                          <td>{{ solve.date|timesince }} ago</td>
                        </tr>
                      {% endfor %}
                    </table>
                  {% else %}
                    <p>None yet!</p>
                  {% endif %}
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
{% endblock %}
